* ライブラリ

Elephant は次のものを使ってください。

darcs get --tag=ELEPHANT-1-0-A2 http://www.common-lisp.net/project/elephant/darcs/elephant-1.0

Elephant は UFFI を必要としています。
CFFI の cffi-uffi-compat わ使わずちゃんと UFFI を使ってください。


* 実装

Web サーバは Hunchentoot を使っています。

データストアは Elephant の CLSQL SQLite3 バックエンドを使っています。

SQLite3 のファイルは config.lisp で指定しています。

認証はベーシック認証です。


* 設定

config.lisp の *default-directory* を設定してください。
(defparameter *default-directory* "/home/deployer/clbuild/source/tech-blog/")


* データ移行

(load "quick-start.lisp") を実行してください。


* 実行ファイルの作り方

config.lisp で次のパラメータを設定する。
(defparameter *default-directory* "/var/www/tech-blog/"
  "stylesheets, images, db ディレクトリを配置するディレクトリ。
db ディレクトリの下に blog.db という名前で SQLite3 のファイルが作成される。")
(defparameter *http-port* 8889 "HTTP のポート")
(defparameter *swank-port* 4009 "SLIME のポート")

次のコマンドを実行する。
sbcl --load exe.lisp

tech-blog という実行ファイルが作成される。



* アップのしかた

ssh deployer@satsuma
cd ~/clbuild/source/tech-blog
sbcl --load "exe.lisp"    # 実行ファイル作成
scp tech-blog deployer@its.actindi.net:/var/www/tech/
scp -r stylesheets images db deployer@its.actindi.net:/var/www/tech/

* 動かしかた

何故か screen だとだめだったので tmux を使ってます。

ssh deployer@its.actindi.net
cd /var/www/tech

まだ起動していない場合
tmux
./tech-blog

既に起動している場合
tmux attach
C-c
./tech-blog
